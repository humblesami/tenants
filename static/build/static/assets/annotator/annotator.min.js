!function(){var e,t,n,o=0,r=[],i=!1,a=!1,s=!1,u=!1,d=!1,c=!1,l=void 0,f=void 0,p=void 0,v=void 0,m=void 0,h=void 0,g=void 0,y=void 0,b=void 0,_=function(){console.log("Load comment not defined")},w=function(){console.log("Save annotation not defined")},x=function(){console.log("onAnnotationsDownloaded not defined")};function A(){$(".topbar:first .cursor:first").click()}function C(e){var t=P(e,e+"/version");return isNaN(t)&&bootbox.alert("Cookie1 must have been se, plz contact support"),t}function S(e){var t=P(e,e+"/dirty");return isNaN(t)&&bootbox.alert("Cookie2 must have been set for "+e+", plz contact support"),t}function E(e){if(1!=S(e)){var t=P(e,e+"/version");t+=1,localStorage.setItem(e+"/version",t),localStorage.setItem(e+"/dirty",1)}}function k(e){localStorage.setItem(e+"/dirty",0)}function L(e,t){localStorage.setItem(e+"/version",t)}function P(e,t){O(e,t);var n=localStorage.getItem(t);return isNaN(n)||(n=parseFloat(n)),n}function I(e,t,n){var o=O(e,t);"dirty"!=o&&"version"!=o||(bootbox.alert("Should not happend"),console.trace()),localStorage.setItem(t,n)}function O(e,t){var n=t.replace(e+"/","");return-1==["version","annotations","dirty","scale","rotate","pen/size","pen/color","text/size","text/color"].indexOf(n)&&(console.trace(),bootbox.alert("Please report this issue2 with "+t+" for "+e)),n}function M(){t&&t.length>0&&($("#annotated-doc-conatiner").hide(),i=!1,t.hide(),$(".router-outlet").show(),w("Leaving"))}$(function(){var e=!1;$(document).on("mouseup","#viewer",function(t){2!=t.button&&1==o&&setTimeout(function(){var n=window.getSelection();if(1!=o||"Range"!=n.type||0==n.baseOffset&&0==n.focusOffset){var r=$(".toolbar .pen").hasClass("active"),i=$(".toolbar .cursor").hasClass("active");$(".toolbar .comment").hasClass("active")?e=!!e:r||i||A()}else{var a=$(".annotation-options.ContextMenuPopup");a.css({left:t.pageX-a.width()/2,top:t.clientY+12}).show(),u=!0}},10)})});var N=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(O,N,j){try{var T,R,B,D=U(j(2)),q=(U(j(4)),function(){}),F=void 0,z=!1;$(document).height(),$(document).width(),window.init_doc_comments=function(){(t=$("#comment-wrapper")).resizable(),T=t.find("#commentText"),R=t.find(".comment-list:first"),B=t.find(".comment-list-container:first"),T.focus(function(){c=!0}),A(),$(window).unbind("unload",M),$(window).bind("unload",M),n=$("#content-wrapper")},e=localStorage.getItem("user"),e=JSON.parse(e);var W=!1;function U(e){return e&&e.__esModule?e:{default:e}}var Y=D.default.UI,X={};D.default.setStoreAdapter(new D.default.LocalStoreAdapter);var J=0,V=void 0,G=D.default.getStoreAdapter();le="",function(){function e(e,t,n,o){if(0==e.length&&(e=oe()),0!=e.length||0!=n.length){(e=(e=e.filter(function(e){return"point"!=e.type||e.sub_type})).concat(n)).forEach(function(e){e.class="Annotation"});var r="";Array.isArray(e)?(r=JSON.stringify(e),I(z,z+"/annotations",r),L(z,t),k(z),ue(o)):bootbox.alert("invalid annotations")}else o&&o.first_time&&ue(o)}x=function(t,n){var o=t.comments;Array.isArray(o)||(o=[],console.log("Why not comments"));var r=C(z);t.annotations||(t.annotations=[]);var i=void 0,a=S(z);t.version>r?1==a?(i="Document annotation version="+t.version+" available from server,",i+="<br>You have older version="+r+" at local.",i+="<br>If you download, it will discard your recent changes,",i+="<br>Do you still want to download?",bootbox.confirm(i,function(r){e(r?t.annotations:[],t.version,o,n)})):e(t.annotations,t.version,o,n):e([],t.version,o,n)}}(),function(){function e(e){console.log(e)}w=function(t){if(q(1),z){if(1==S(z)){var n=C(z),o={id:doc_id,doc_id:z};if(delete o.reset,"reset"==t)o.reset=1;else{var r=localStorage.getItem(z+"/annotations");if(!r||"[]"==r)return void console.log("No annotations");0==n&&(E(z),L(z,1)),o.annotations=r,o.version=n}dn_rpc_object({data:{args:{app:"documents",model:"AnnotationDocument",method:"add_annotation"},params:o},no_loader:1,onSuccess:function(e){!function(e,t){if("done"!=e){if(isNaN(e))return bootbox.alert("Could not save:"),void console.log(e);var n=C(z);le="Server already has version="+e,le+="<br>Do you want to overwrite server version with local="+n+"?",bootbox.confirm(le,function(t){t&&(L(n=e+1),w())})}else k(z),console.log("Saved")}(e)},onError:e,type:"post"})}}else console.log("saveAnnotationsAtServer must be called after document id is set")},window.saveAnnotationsAtServer=w,$("body").on("click",".doc-saver",function(){w()})}(),$("body").on("click",".cb-container.autosave input",function(){$(this).prop("checked")&&w()}),$("body").on("click",".toolbar .back",function(){M()}),$("body").on("click",".doc-reseter",function(){le="Do you want to erase all annotations on document.",le+="<br>Warning: It will also reset.",bootbox.confirm(le,function(e){if(e){var t=localStorage.getItem(z+"/annotations");t=(t=JSON.parse(t)).filter(function(e){return"point"==e.type&&!e.sub_type}),t=JSON.stringify(t),localStorage.removeItem(z+"/annotations"),localStorage.setItem(z+"/annotations",t),E(z),w("reset")}})}),$("body").on("click",".ContextMenuPopup.toolbar:first .copy:first",function(){document.execCommand("copy"),$(this).parent().parent().hide()}),$(document).mousedown(function(e){if(2!=e.button){var t=$(e.target);c&&0==t.closest("#comment-wrapper").length&&(c=!1,_()),!u||t.is(".ContextMenuPopup button")||t.is(".ContextMenuPopup .colored")||$(".ContextMenuPopup").hide(),$(".topbar:first .pen:first").hasClass("active")?r.length>0&&0==t.closest("#viewer").length&&q():($(".pdfViewer").css("cursor","default"),F&&0==t.closest("#comment-wrapper").length?(F=void 0,$(".comment-list-form").hide()):$(".toolbar .comment").hasClass("active")&&0==t.closest("#viewer").length&&A())}}),$("body").on("click",".cell.colored",function(){var e=$(this),t=e.attr("hex").substring(1);p?p.color!=t&&(p.color=t,G.editAnnotation(z,f,p).then(function(t){e.append($("#applied_color").show())})):($(".topbar .pen-color:first").css("background",t),$(".topbar .pen-color:first").attr("color",t),H(null,t),e.append($("#applied_color").show()))}),$(".notification-list:first").on("click, li.list-group-item contact",function(){console.log(1344)});var H=function(e,t){},Z="top",K="left",Q=void 0;function ee(e,t){for(var n in e=e.filter(function(e){return"point"==e.type&&!e.sub_type})){var o=e[n],r="<div db_id="+o.id+" point_id="+o.uuid+' class="new_comments_count"',i=o.y*Q-15,a=o.x*Q+15,s=Z+":"+i+"px;"+K+":"+a+"px;";0==o.counter&&(s+="display:none;"),r+=' style="'+s+'" comment_count="'+o.counter+'">'+o.counter+"</div>",$("#pageContainer"+t+" .canvasWrapper").append(r)}}function te(){t.hide(),i=!1,localStorage.removeItem(z+"/shown_comment_type")}function ne(e){e&&(a=e),"notes"==a?t.find(".title:first").html("Personal Notes"):t.find(".title:first").html("Comments"),t.show(),F?$(".comment-list-form").show():$(".comment-list-form").hide(),i=a,$(".comment-header").offset().top;try{parseInt(B.css("padding-bottom"))}catch(e){}var o=n.offset().top;n.height(window.innerHeight-o),localStorage.setItem(z+"/shown_comment_type",i)}function oe(){var e=P(z,z+"/annotations");return e=e?JSON.parse(e):[]}function re(){T.html(""),T.parent().show(),R.scrollTop(999999e3),T.focus()}function ie(e,t){e.counter=0,ae(e,0)}function ae(e,t,n){var o=P(z,z+"/annotations");for(var r in o=o?JSON.parse(o):[])if(o[r].uuid==e.uuid){var i=0;if(0!=t&&(i=t,o[r].counter&&(i+=o[r].counter)),e.counter=i,o[r].counter=i,!n){var a=$('.new_comments_count[point_id="'+e.uuid+'"]');0==i?a.hide():a.show(),a.html(i).attr("comment_count",i)}localStorage.setItem(z+"/annotations",JSON.stringify(o));break}}function se(n){e=window.current_user.cookie,site_functions.hideLoader("Document Data"),b="Document Render Data",site_functions.showLoader(b),n&&n.first_time&&(t=$("#comment-wrapper"),T=t.find("#commentText"),R=t.find(".comment-list:first"),B=t.find(".comment-list-container:first"),d=n.type+"-"+n.id+".pdf",z=n.type+"-"+n.id+"-"+e.id+".pdf",doc_id=n.id,X.documentId=z,W=!1,localStorage.getItem(z+"/dirty")||function(e){localStorage.setItem(e+"/version",0),localStorage.setItem(e+"/scale",1),localStorage.setItem(e+"/roate",0),localStorage.setItem(e+"/dirty",0),localStorage.setItem(e+"/annotations","[]")}(z)),ue(n)}function ue(e){try{var t=n.offset().top;if(n.height(window.innerHeight-t),e&&e.first_time){try{"meeting"==e.type||"topic"==e.type?window.show_annotation=!0:window.show_annotation=!1,$(".topbar:first .annotation_button").hide(),n.hide(),$(".strt_sign.pdfjs").hide(),$(".sign_completed.pdfjs").hide(),$(".router-outlet").hide(),$(".doc-reseter").hide(),$(".toolbar.topbar:first").show(),$("#annotated-doc-conatiner").show(),te(),function(){function e(e,t){e=parseFloat(e,10),t=parseInt(t,10),$("#viewer").width(),X.scale,(X.scale!==e||X.rotate!==t)&&(X.scale=e,X.rotate=t,I(X.documentId,X.documentId+"/scale",X.scale),P(X.documentId,X.documentId+"/scale"),I(X.documentId,X.documentId+"/rotate",X.rotate%360),se())}var t=document.querySelector(".toolbar select.scale");function n(){e(t.value,X.rotate)}t.onchange=n,document.querySelector(".toolbar .rotate-ccw").addEventListener("click",function(){e(X.scale,X.rotate-90)}),document.querySelector(".toolbar .rotate-cw").addEventListener("click",function(){e(X.scale,X.rotate+90)}),$(".toolbar:first .zoomin")[0].onclick=function(){if(!(X.scale>=5)){var e=t.children[t.selectedIndex];t.value=$(e).next().val(),n()}},$(".toolbar:first .zoomout")[0].onclick=function(){if(!(X.scale<=.25)){var e=t.children[t.selectedIndex];t.value=$(e).prev().val(),n()}}}();var r=$(".toolbar select.scale:first");(X={documentId:z,scale:P(z,z+"/scale"),rotate:P(z,z+"/rotate"),pdfDocument:null}).rotate||(X.rotate=360,I(z,z+"/rotate",360)),X.scale||(X.scale=1,I(z,z+"/scale",1)),r.val(X.scale);var i=n.prev()[0].getBoundingClientRect().bottom;n.height(window.innerHeight-40-i)}catch(e){console.log(e)}if(!e.type)return bootbox.alert("Invalid document data ",e),void site_functions.hideLoader(b);try{if(e.url)if(window.location.toString().indexOf("4200")>-1)e.doc=site_config.site_url+"/static/assets/a.pdf";else{var a=window.site_config.server_base_url+e.url;console.log(window.site_config.server_base_url,e.url,a),e.doc=a}else{e.doc.startsWith("data:application/pdf;base64,")&&(e.doc=e.doc.replace("data:application/pdf;base64,",""));for(var s=atob(e.doc),u=new Uint8Array(s.length),d=0;d<s.length;d++)u[d]=s.charCodeAt(d);e.doc=u}X.document_data=e,site_functions.hideLoader(b),b="document content",site_functions.showLoader(b),console.log(window.dt_functions.now_full(),"downloading doc data at client"),PDFJS.getDocument(e.doc).then(function(e){console.log(window.dt_functions.now_full(),"download completed"),V=e,$(".page-count").html(V.numPages),V.numPages>1&&$(".page-next-btn").removeAttr("disabled"),site_functions.hideLoader(b),b="document pages",site_functions.showLoader(b),c(V)})}catch(e){console.log(e)}}else{if(!X.document_data)return bootbox.alert("Invalid render options data ",X),void site_functions.hideLoader(b);X.document_data.doc,z=X.documentId,c(V)}function c(t){try{if(!t)return alert("PDF not loaded"),void site_functions.hideLoader(b);X.pdfDocument=t;var r=document.getElementById("viewer");r.innerHTML="",J=t.pdfInfo.numPages;for(var i=0;i<J;i++){var a=Y.createPage(i+1);r.appendChild(a)}Q=$("select.scale").val();var s=X.rotate%360;switch(function(e){var t=X.document_data,n=t.type;if(0!=e||"meeting"!=n&&"topic"!=n)o=0,$(".annot-toggler").hide(),"meeting"!=n&&"topic"!=n||(o=2),X.showAnnotations=!1,$(".topbar:first .annotation_button").hide(),"signature"==t.type&&($(".strt_sign").attr("doc_id",t.id),"Pending"==t.mp_signature_status&&($(".sign_completed.pdfjs").hide(),$(".strt_sign.pdfjs").show()),"Completed"==t.mp_signature_status&&($(".strt_sign.pdfjs").hide(),$(".sign_completed.pdfjs").show()));else{o=1,X.showAnnotations=!0;var r=P(X.documentId,X.documentId+"/pen/size")||1,i=P(X.documentId,X.documentId+"/pen/color")||"#000000";H(r,i),$(".topbar:first .annotation_button").show(),$(".annot-toggler").show()}}(s),s){case 90:Z="right",K="top";break;case 180:Z="bottom",K="right";break;case 270:Z="left",K="bottom"}}catch(e){console.log(e)}function u(t,r){try{1==r&&(site_functions.hideLoader(b),first_page_rendered=1,e&&e.first_time&&$("body").addClass("pdf-viewer"),n.show(),console.log(window.dt_functions.now_full(),"first page done")),1==o&&ee(t,r),r==J&&(function(){try{if($(".ToolBarWrapper>div").css({display:"flex"}),document_version=C(z),!e||!e.first_time)return;var t=window.socket_manager,n={id:doc_id,doc_id:z,version:document_version},n={args:{app:"documents",model:"AnnotationDocument",method:"get_annotations"},no_loader:1,params:{id:doc_id,doc_id:z,version:document_version}};dn_rpc_object({data:n,no_loader:1,onSuccess:function(t){e.first_time=void 0,x(t,e)},onError:function(e){console.log(e)}}),t.execute_on_verified(function(){var e=t.notificationList;$(".canvasWrapper .new_comments_count").each(function(t,n){var o={res_app:"documents",res_model:"PointAnnotation",res_id:parseInt($(n).attr("db_id"))};for(var r in e)e[r].address.res_app==o.res_app&&e[r].address.res_model==o.res_model&&e[r].address.res_id==o.res_id&&(console.log(t,r,e[r].count,134),$(n).attr("counter",$(n).attr("counter")+e[r].count))})})}catch(e){console.log(e)}}(),console.log(window.dt_functions.now_full(),"document done"))}catch(e){console.log(e)}}try{Y.renderPage(1,X,function(e,t){u(e,t);for(var n=2;n<=J;n++)Y.renderPage(n,X,function(e,t){u(e,t)})})}catch(e){console.log(e)}}window.show_annotation?($(".annotationLayer").show(),$(".annotation_button").show()):($(".annotationLayer").hide(),$(".annotation_button").hide())}catch(e){console.log(e)}}q=function(e){if(r.length>0){var t=P(z,z+"/annotations");t=JSON.parse(t);var n=r[0];t=t.filter(function(e){return 1!=e.to_merge});for(var o=1;o<r.length;o++)n.lines=n.lines.concat(r[o].lines);n.to_merge=0,t.push(n),localStorage.setItem(z+"/annotations",JSON.stringify(t)),r=[],n={},e||ue()}},de=void 0,ce=void 0,H=function(e,t){var n=!1;e&&"number"!=typeof e&&(e=parseInt(e)),t&&6==t.length&&(t="#"+t),e&&de!==e&&(n=!0,de=e,I(X.documentId,X.documentId+"/pen/size",de),document.querySelector(".toolbar .pen-size").value=de),t&&ce!==t&&(n=!0,ce=t,I(X.documentId,X.documentId+"/pen/color",ce),$(".toolbar .pen-color:first").css("background-color",ce),$(".toolbar .pen-color:first").attr("color",t),$("select.pen-size").css("color",t),$("select.pen-size option").css("color",t)),n&&Y.setPen(de,ce)},$("body").on("click",".toolbar .pen-color:first",function(e){var t=$(".topbar:first").width(),n=$(".ColorPalettePopup:first"),o=this.getBoundingClientRect(),r={top:o.y+20};t/2>o.x?r.left=o.x:r.left=o.x-n.width(),n.css(r).show();var i=$(this).attr("color");n.find('div[hex="'+i+'"]:first').click()}),$("body").on("change",".toolbar .pen-size:first",function(e){H(e.target.value,ce)}),function(){var e="cursor";function t(t,n){Y.disablePoint();var o=$(".toolbar button.active");if(o.length>0)switch(o.removeClass("active"),e){case"cursor":Y.disableEdit();break;case"draw":Y.disablePen();break;case"text":Y.disableText();break;case"point":Y.disablePoint();break;case"area":case"highlight":case"strikeout":case"underline":Y.disableRect()}switch($(n).addClass("active"),e=t,t){case"cursor":Y.enableEdit();break;case"draw":Y.enablePen();break;case"text":Y.enableText();break;case"point":$(".pdfViewer").css("cursor","crosshair"),Y.enablePoint();break;case"area":case"highlight":case"strikeout":case"underline":Y.enableRect(t)}}$("body").on("click",".toolbar.topbar:first button, .toolbar.annotation-options:first button",function(e){var n=$(".topbar:first .active"),o=$(e.target);if((o=o.closest("button")).hasClass("pen")&&n.hasClass("pen"))A();else{var r=$(e.target).closest("[data-tooltype]").data("tooltype");r&&t(r,e.target)}o.hasClass("comment")&&(s=!!o.hasClass("personal")&&"personal")})}(),function(r,i){r.on_annotation_comment_received=function(e){var n=$("#annotated-doc-conatiner");if(!(n.length<1)&&(n=n.is(":visible"))&&1==o&&n&&e.point.comment_doc_id==d){var r=B.attr("annotation-id");if(e.new_point){e.point.counter=1;var i=oe();i.push(e.point),i=JSON.stringify(i),I(z,z+"/annotations",i),Y.renderPage(e.point.page,X,function(n,o){G.addComment(z,e.point.uuid,e.point.comment,1).then(function(e){S(e,1),t.find(".comment-list-item:last").css({background:"green",color:"white"})}),ee(n,o),ae(e.point,1,1)})}else e.point.uuid==r?(G.addComment(z,e.point.uuid,e.point.comment,1).then(function(e){S(e,1),t.find(".comment-list-item:last").css({background:"green",color:"white"})}),ie(e.point)):(G.addComment(z,e.point.uuid,e.point.comment,1),ae(e.point,1))}};var s=localStorage.getItem("user");function c(){if(r.should_save){g=[],$(".active-mention a.mention").each(function(e,t){var n=$(t).attr("mentioned_id");-1==g.indexOf(n)&&g.push(parseInt(n))});var t=T.html();if(""!=(t=t.substr(0,t.length-1))){var n={date_time:new Date,user_name:e.name,uid:e.id,user_image:e.photo,content:t};if(!n.content)return!1;G.addComment(z,F,n).then(function(e){S(e,1)})}else T.html("")}else r.should_save=!0}function b(e){W=1,setTimeout(function(){e?l(e):(ne(a),T.closest("form").hide())},11)}function w(e,t,n){var o=i.createElement("div");for(var r in o.classList.add("groupcomment"),e){var a=C(e[r]);o.appendChild(a)}$(o).attr("annotationId",t),B.append(o)}function x(e){B.html(""),e.forEach(S)}s=JSON.parse(s),$("body").on("keyup","#commentText",function(e){F?e.shiftKey||13!=e.keyCode||(e.preventDefault(),c()):console.log("Comment not added because, no active annotationId")}),$("body").on("click",".commentText1",function(e){c()}),_=function(e){B.html(""),B.removeAttr("annotation-id"),$(".comment-list-container").addClass("full-discussion");var t=!1;"notes"==a&&(t="personal"),G.getPointAnnotations(z,t).then(function(t){(t=t.annotations).sort(function(e,t){return e.page-t.page||e.y-t.y||e.x-t.x});var n=-1,o=-1,r=t.length;for(var i in t)++n,G.getComments(z,t[n].uuid).then(function(n){var i=t[++o];w(n,i.uuid,i.sub_type),o+1==r&&b(e)});-1==n&&b(e)})};var A=!1;function C(e){var t=i.createElement("div");t.className="comment-list-item",e.date_time=r.dt_functions.standeredTime(e.date_time);var n=e.user_name,o="";if(e.user)if(n=e.user.name,e.user.image)o='<img class="img-fluid" id="navbar-profile-img" src="'+(o=r.site_config.server_base_url+e.user.image)+'">';else{var a=n.match(/\b\w/g)||[];o="<span>"+(a=((a.shift()||"")+(a.pop()||"")).toUpperCase())+"</span>"}var s="";return s+='<div class="user-pic-time-infoWrapper">',s+='<div class="userSmpic icon-user-single">',s+=+o,s+="</div>",s+='<div class="user-time-info pt-2">',s+='<span class="user text-primary">',s+=e.user_name+"</span>",s+='<span class="time small">',s+=r.dt_functions.timeAgo(e.date_time),s+="</div>",s+="</div>",s+='<div class="comment-details pt-1 pl-1">',s+="<p>"+e.content+"</p>",s+="</div>",$(t).attr("comment-id",e.uuid),$(t).attr("annotation",e.annotation),t.innerHTML=s,t}function S(e,t){var n=C(e);B.append(n),t&&re()}$("body").on("click","#comment-wrapper .buttons",function(e){e.preventDefault(),u=!0,A=$(this).closest(".comment-list-item"),$(".update-comment:first").css({top:e.pageY,left:e.pageX}).show()}),$("body").on("click",".annotation_button.unread",function(){for(var e=$(".canvasWrapper .new_comments_count"),t=e.length,n=0;n<t;n++){var o=e.eq(n);if(parseInt(o.html())>0){l(o.attr("point_id"));break}}}),$("body").on("click",".update-comment:first .delete",function(e){var t=A.closest(".groupcomment"),n=A.attr("comment-id"),o=A.attr("annotation");G.deleteComment(z,o,n).then(function(){1==t.children(".comment-list-item").length?t.remove():A.remove(),u=!1,$(".update-comment").hide()})}),$("body").on("click",".show-all-comments",function(){setTimeout(te,50)}),l=function(e){if(W){var t=void 0;if(t="string"==typeof e?e:e.attr("annotationId")){var o=$("svg.annotationLayer").find('svg[data-pdf-annotate-id="'+t+'"]');if(o.length>0){var r=$('.canvasWrapper .new_comments_count[point_id="'+t+'"]');setTimeout(function(){n.scrollTop(0);var e=r.closest(".canvasWrapper"),t=e.height()*(e.closest(".page").index()+1),i=r[0],a=parseFloat(i.style.top)-100,s=parseFloat(i.style.left)-100,u=t+a;n.scrollLeft(s),n.animate({scrollTop:u},500),m(o[0])},15)}else console.log(target,"Not found")}else console.log("Invalid point id")}else _(e)},$("body").on("click","#comment-wrapper .groupcomment",function(e){$(e.target).is(".buttons")||l($(this))}),h=function(e){G.getAnnotation(z,f).then(function(t){if(p=t,function(e){var t=e.getAttribute("data-pdf-annotate-type");return["point"].indexOf(t)>-1}(e))y(t);else{var n=$(".colors.ContextMenuPopup:first"),o=$(e).position(),r=$("#pdf-annotate-edit-overlay:visible").width(),i=n.width(),a=o.left+r/2-i/2,s=$(e).attr("fill");s||(s=$(e).attr("stroke")),"none"!=s&&s||(s="#000000");var d=n.find('.row>.cell[hex="'+s+'"]');0==d.length?$("#applied_color").hide():d.append($("#applied_color").show()),n.css({left:a,top:o.top+30}).show(),u=!0}})},y=function(e){F=f,G.getComments(z,f).then(x).then(function(){if(e.counter>0){var n=t.find(".comment-list-item").length;n=n-e.counter-1,t.find(".comment-list-item:gt("+n+")").css({background:"green",color:"white"}),ie(e,e.counter)}}),p.sub_type?($(".comment-list-container").addClass("full-discussion"),B.removeAttr("annotation-id"),ne("notes")):($(".comment-list-container").removeClass("full-discussion"),B.attr("annotation-id",f),$("#pdf-annotate-edit-overlay a").remove(),ne("comments")),re()},v=function(){p=!1},$(r).width(),$(r).height(),$(i).height(),$("body").on("click",".toolbar:first .comment",function(){Y.destroyEditOverlay(),a=$(this).is(".personal")?"notes":"comments",_()}),Y.addEventListener("annotation:click",m),Y.addEventListener("annotation:blur",v)}(window,document),N.pdf_render=se}catch(e){console.log(e)}var de,ce;var le},function(e,t,n){!function(){if(null==e)var e={};e.txt={}}()},function(t,n,o){var i,a,u;(function(t){"use strict";var o,c=void 0,p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};o=function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(1),i=(o=r)&&o.__esModule?o:{default:o};t.default=i.default,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=s(n(2)),r=s(n(8)),i=s(n(10)),a=s(n(28));function s(e){return e&&e.__esModule?e:{default:e}}t.default={StoreAdapter:o.default,LocalStoreAdapter:r.default,__storeAdapter:new o.default,getStoreAdapter:function(){return this.__storeAdapter},setStoreAdapter:function(e){this.__storeAdapter=e},UI:a.default,render:i.default,getAnnotations:function(e,t){var n;return(n=this.getStoreAdapter()).getAnnotations.apply(n,arguments)}},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(3),a=(o=i)&&o.__esModule?o:{default:o},s=n(4),u=function(){function e(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.keys(n).forEach(function(e){"function"==typeof n[e]&&"function"==typeof t[e]&&(t[e]=n[e])})}return r(e,[{key:"__getAnnotations",value:function(e,t){(0,a.default)("getAnnotations")}},{key:"getAnnotation",value:function(e,t){(0,a.default)("getAnnotation")}},{key:"getCommentAnnotations",value:function(e){(0,a.default)("getCommentAnnotations")}},{key:"getPointAnnotations",value:function(e,t){(0,a.default)("getPointAnnotations")}},{key:"__addAnnotation",value:function(e,t,n){(0,a.default)("addAnnotation")}},{key:"__editAnnotation",value:function(e,t,n){(0,a.default)("editAnnotation"),destroyEditOverlay()}},{key:"__deleteAnnotation",value:function(e,t){(0,a.default)("deleteAnnotation")}},{key:"getComments",value:function(e,t){(0,a.default)("getComments")}},{key:"getAllComments",value:function(e){(0,a.default)("getAllComments")}},{key:"__addComment",value:function(e,t,n){(0,a.default)("addComment")}},{key:"__editComment",value:function(e,t){(0,a.default)("editComment")}},{key:"__deleteComment",value:function(e,t,n){(0,a.default)("deleteComment")}},{key:"getAnnotations",get:function(){return this.__getAnnotations},set:function(e){this.__getAnnotations=function(t,n){return e.apply(void 0,arguments).then(function(e){return e.annotations&&e.annotations.forEach(function(e){e.documentId=t}),e})}}},{key:"addAnnotation",get:function(){return this.__addAnnotation},set:function(e){this.__addAnnotation=function(t,n,o){return e.apply(void 0,arguments).then(function(e){return(0,s.fireEvent)("annotation:add",t,n,e),e})}}},{key:"editAnnotation",get:function(){return this.__editAnnotation},set:function(e){this.__editAnnotation=function(t,n,o){return e.apply(void 0,arguments).then(function(e){return(0,s.fireEvent)("annotation:edit",t,n,e),e})}}},{key:"deleteAnnotation",get:function(){return this.__deleteAnnotation},set:function(e){this.__deleteAnnotation=function(t,n){return e.apply(void 0,arguments).then(function(e){return e&&(0,s.fireEvent)("annotation:delete",t,n),e})}}},{key:"addComment",get:function(){return this.__addComment},set:function(e){this.__addComment=function(t,n,o){return e.apply(void 0,arguments).then(function(e){return(0,s.fireEvent)("comment:add",t,n,e),e})}}},{key:"editComment",get:function(){return this.__editComment},set:function(e){this.__editComment=function(t,n){return e.apply(void 0,arguments).then(function(e){return e&&(0,s.fireEvent)("comment:edit",t,n),e})}}},{key:"deleteComment",get:function(){return this.__deleteComment},set:function(e){this.__deleteComment=function(t,n,o){return e.apply(void 0,arguments).then(function(e){return e&&(0,s.fireEvent)("comment:delete",t,n,o),e})}}}]),e}();t.default=u,e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){throw new Error(e+" is not implemented")},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.fireEvent=function(){s.emit.apply(s,arguments)},t.addEventListener=function(){s.on.apply(s,arguments)},t.removeEventListener=function(){s.removeListener.apply(s,arguments)};var o,r=n(5),i=(o=r)&&o.__esModule?o:{default:o},a=n(6),s=new i.default,u=void 0;document.addEventListener("click",function(e){if($(".toolbar .cursor").hasClass("active")&&(0,a.findSVGAtPoint)(e.clientX,e.clientY)){var t=(0,a.findAnnotationAtPoint)(e.clientX,e.clientY);u&&u!==t&&s.emit("annotation:blur",u),t&&(s.emit("annotation:click",t),u=t)}})},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function r(e){return"object"===(void 0===e?"undefined":p(e))&&null!==e}function i(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,a,s,u,d;if(this._events||(this._events={}),"error"===e&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(i(n=this._events[e]))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(r(n))for(s=Array.prototype.slice.call(arguments,1),a=(d=n.slice()).length,u=0;u<a;u++)d[u].apply(this,s);return!0},n.prototype.addListener=function(e,t){var a;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?r(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,r(this._events[e])&&!this._events[e].warned&&(a=i(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[e].length>a&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!o(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var n,i,a,s;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(n=this._events[e]).length,i=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(r(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(o(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.BORDER_COLOR=void 0,t.findSVGContainer=function(e){for(var t=e;(t=t.parentNode)&&t!==document;)if("SVG"===t.nodeName.toUpperCase()&&"true"===t.getAttribute("data-pdf-annotate-container"))return t;return null},t.findSVGAtPoint=s,t.findAnnotationAtPoint=function(e,t){var n=s(e,t);if(n){for(var o=n.querySelectorAll("[data-pdf-annotate-type]"),r=0,i=o.length;r<i;r++){var a=o[r];if(u(e,t,d(a)))return a}return null}},t.pointIntersectsRect=u,t.getOffsetAnnotationRect=d,t.getAnnotationRect=c,t.scaleUp=l,t.scaleDown=function(e,t){var n={},o=p(e).viewport;return Object.keys(t).forEach(function(e){n[e]=t[e]/o.scale}),n},t.getScroll=function(e){for(var t=0,n=0,o=e;(o=o.parentNode)&&o!==document;)t+=o.scrollTop,n+=o.scrollLeft;return{scrollTop:t,scrollLeft:n}},t.getOffset=f,t.disableUserSelect=function(){a.parentNode||document.head.appendChild(a)},t.enableUserSelect=function(){a.parentNode&&a.parentNode.removeChild(a)},t.getMetadata=p;var o,r=n(7),i=(o=r)&&o.__esModule?o:{default:o};t.BORDER_COLOR="#00BFFF";var a=(0,i.default)({body:{"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"}});function s(e,t){for(var n=document.querySelectorAll('svg[data-pdf-annotate-container="true"]'),o=0,r=n.length;o<r;o++){var i=n[o];if(u(e,t,i.getBoundingClientRect()))return i}return null}function u(e,t,n){return t>=n.top&&t<=n.bottom&&e>=n.left&&e<=n.right}function d(e){var t=c(e),n=f(e),o=n.offsetLeft,r=n.offsetTop;return{top:t.top+r,left:t.left+o,right:t.right+o,bottom:t.bottom+r}}function c(e){var t=0,n=0,o=0,r=0,i=e.getBoundingClientRect();switch(e.nodeName.toLowerCase()){case"path":var a=void 0,u=void 0,d=void 0,c=void 0;e.getAttribute("d").replace(/Z/,"").split("M").splice(1).forEach(function(e){var t=e.split(" ").map(function(e){return parseInt(e,10)});(void 0===a||t[0]<a)&&(a=t[0]),(void 0===u||t[2]>u)&&(u=t[2]),(void 0===d||t[1]<d)&&(d=t[1]),(void 0===c||t[3]>c)&&(c=t[3])}),t=c-d,n=u-a,o=a,r=d;break;case"line":t=parseInt(e.getAttribute("y2"),10)-parseInt(e.getAttribute("y1"),10),n=parseInt(e.getAttribute("x2"),10)-parseInt(e.getAttribute("x1"),10),o=parseInt(e.getAttribute("x1"),10),r=parseInt(e.getAttribute("y1"),10),0===t&&(t+=16,r-=8);break;case"text":t=i.height,n=i.width,o=parseInt(e.getAttribute("x"),10),r=parseInt(e.getAttribute("y"),10)-t;break;case"g":var p=f(e),v=p.offsetLeft,m=p.offsetTop;t=i.height,n=i.width,o=i.left-v,r=i.top-m,"strikeout"===e.getAttribute("data-pdf-annotate-type")?(t+=16,r-=8):"underline"===e.getAttribute("data-pdf-annotate-type")&&(t+=16,r-=14);break;case"rect":case"svg":t=parseInt(e.getAttribute("height"),10),n=parseInt(e.getAttribute("width"),10),o=parseInt(e.getAttribute("x"),10),r=parseInt(e.getAttribute("y"),10)}var h={top:r,left:o,width:n,height:t,right:o+n,bottom:r+t};return["svg","g"].includes(e.nodeName.toLowerCase())||(h=l(s(i.left,i.top),h)),h}function l(e,t){var n={},o=p(e).viewport;return Object.keys(t).forEach(function(e){n[e]=t[e]*o.scale}),n}function f(e){for(var t=e;(t=t.parentNode)&&t!==document&&"SVG"!==t.nodeName.toUpperCase(););var n=t.getBoundingClientRect();return{offsetLeft:n.left,offsetTop:n.top}}function p(e){return{documentId:e.getAttribute("data-pdf-annotate-document"),pageNumber:parseInt(e.getAttribute("data-pdf-annotate-page"),10),viewport:JSON.parse(e.getAttribute("data-pdf-annotate-viewport"))}}a.setAttribute("data-pdf-annotate-user-select","true")},function(e,t){e.exports=function(e){var t=document.createElement("style"),n=Object.keys(e).map(function(t){return function(e,t){return e+" {\n"+function(e){return Object.keys(e).map(function(t){return function(e,t){return isNaN(t)||0==t||(t+="px"),function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}(e)+": "+t+";"}(t,e[t])}).join("\n")}(t)+"\n}"}(t,e[t])}).join("\n");return t.setAttribute("type","text/css"),t.appendChild(document.createTextNode(n)),t}},function(t,n,o){Object.defineProperty(n,"__esModule",{value:!0});var i=s(o(9)),a=s(o(2));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":p(t))&&"function"!=typeof t?e:t}(this,Object.getPrototypeOf(n).call(this,{getAnnotations:function(t,n){return new Promise(function(o,r){var i=c(t).filter(function(t){return t.page===n&&"Annotation"===t.class&&(t.uid==e.id||"point"==t.type&&!t.sub_type)});o({documentId:t,pageNumber:n,annotations:i})})},getCommentAnnotations:function(t,n){return new Promise(function(n,o){var r=c(t).filter(function(t){return"point"==t.type&&"Annotation"===t.class&&(t.uid==e.id||!t.sub_type)});n({documentId:t,annotations:r})})},getPointAnnotations:function(t,n){return new Promise(function(o,r){var i=c(t).filter(function(t){return n?"point"==t.type&&"Annotation"===t.class&&t.uid==e.id&&t.sub_type:"point"==t.type&&"Annotation"===t.class&&!t.sub_type});o({documentId:t,annotations:i})})},getCommentPoints:function(e){return this.getCommentAnnotations(e)},getNotePoints:function(e){return this.getCommentAnnotations(e,sub_type)},getAnnotation:function(e,t){return Promise.resolve(c(e)[v(e,t)])},addAnnotation:function(t,n,o){return new Promise(function(a,s){if("string"==typeof o.type)if(e.id)if(o.class="Annotation",o.uuid=(0,i.default)(),o.page=n,o.date_time=new Date,e.id){o.uid=e.id;var u=c(t);u.push(o),"drawing"==o.type&&(o.to_merge=1,r.push(o));var d="pooint"==o.type&&!o.sub_type;f(t,u,d),a(o)}else console.log("oops no user id");else bootbox.alert("No user Id given");else console.log("Invalid annotation",o)})},editAnnotation:function(e,t,n){return new Promise(function(o,r){var i=c(e);i[v(e,t)]=n,f(e,i),function(e,t,n){document.querySelectorAll('[data-pdf-annotate-id="'+e+'"]').forEach(function(e){var o=!1;switch(t){case"strikeout":case"underline":o="stroke";break;case"highlight":o="fill";break;case"drawing":-1==n.indexOf("#")&&(n="#"+n),$(e).attr("stroke",n),o="fill"}o&&$(e).attr(o,"#"+n)})}(t,n.type,n.color),o(n)})},deleteAnnotation:function(e,t){return new Promise(function(n,o){var r=v(e,t);if(r>-1){var i=c(e);i.splice(r,1),f(e,i)}n(!0)})},getComments:function(e,t){return new Promise(function(n,o){var r=c(e).filter(function(e){return e.uuid===t}),i=[];i=Array.isArray(r)&&r.length>0?r[0].comments:[],Array.isArray(i)||(i=[]),n(i)})},getAllComments:function(e){return new Promise(function(t,n){t(c(e).filter(function(e){return"point"===e.type}).sort(function(e,t){return e.page-t.page||e.y-t.y||e.x-t.x})||[])})},addComment:function(e,t,n,o){return new Promise(function(r,a){if(t){var s={class:"Comment",uuid:(0,i.default)(),point_id:t,content:n.content,uid:n.uid,user_name:n.user_name,user:{image:n.user_image},date_time:n.date_time},u=e.split("-"),l={doc_type:u[0],document_id:u[1],comment_doc_name:d},p=c(e),v={},m=-1;for(var h in p)if(p[h].uuid==t){m=h;var y=p[h];for(var b in y)"comments"!=b&&(v[b]=y[b]);break}if(m>-1){p[m].comments?p[m].comments.push(s):p[m].comments=[s],console.log(s),v.comment=s,v.doc_id=e,v.document_id=u[1],v.comment_doc_id=d,l.point=v,l.mentioned_list=g;var _="personal"!=v.sub_type;_&&!o&&(dn_rpc_object({data:{args:{app:"documents",model:"CommentAnnotation",method:"save_comment"},params:l},no_loader:1,onSuccess:function(e){g=[],console.log("comment saved")}}),setTimeout(function(){$(".comment-list-container:first").scrollTop(9999)},10)),f(e,p,_)}else console.log("Annotation not found "+t)}else console.log("Comment not added because, no active annotationId");r(s)})},editComment:function(e,t,n,o){return new Promise(function(r,i){for(var a=c(e),s=0;s<a.length;s++)n===a[s].annotation&&t===a[s].uuid&&(a[s].content=o);f(e,a,1),r(!0)})},deleteComment:function(e,t,n){return new Promise(function(t,o){c(e);for(var r=-1,i=c(e),a=0,s=i.length;a<s;a++)if(i[a].uuid===n){r=a;break}r>-1&&(i.splice(r,1),f(e,i,1)),t(!0)})}}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":p(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,a.default),n}();function c(e){var t=P(e,e+"/annotations");return t=t?JSON.parse(t):[]}n.default=u;var l=void 0;function f(e,t,n){var o="";Array.isArray(t)&&(o=JSON.stringify(t)),I(e,e+"/annotations",o),n||(E(e),clearTimeout(l),l=setTimeout(function(){w()},3e4))}function v(e,t){for(var n=-1,o=c(e),r=0,i=o.length;r<i;r++)if(o[r].uuid===t){n=r;break}return n}t.exports=n.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.replace(n,r)};var n=/[xy]/g,o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function r(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return new Promise(function(r,i){return e.innerHTML="",e.setAttribute("data-pdf-annotate-container",!0),e.setAttribute("data-pdf-annotate-viewport",JSON.stringify(t)),e.removeAttribute("data-pdf-annotate-document"),e.removeAttribute("data-pdf-annotate-page"),n?(e.setAttribute("data-pdf-annotate-document",n.documentId),e.setAttribute("data-pdf-annotate-page",n.pageNumber),Array.isArray(n.annotations)&&0!==n.annotations.length?(n.annotations.forEach(function(n){(0,o.default)(e,n,t)}),void r(e)):r(e)):r(e)})},r(n(1));var o=r(n(11));function r(e){return e&&e.__esModule?e:{default:e}}r(n(20)),e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){n||(n=JSON.parse(e.getAttribute("data-pdf-annotate-viewport")));var u=void 0;switch(t.type){case"area":case"highlight":u=(0,a.default)(t);break;case"strikeout":case"underline":u=(0,o.default)(t);break;case"point":u=(0,i.default)(t);break;case"textbox":u=(0,s.default)(t);break;case"drawing":u=(0,r.default)(t)}return u&&(u.setAttribute("data-pdf-annotate-id",t.uuid),u.setAttribute("data-pdf-annotate-type",t.type),u.setAttribute("aria-hidden",!0),e.appendChild(function(e,t){var n=function(e){var t=void 0,n=void 0,o=e.rotation%360;switch(o<0&&(o+=360),o){case 0:t=n=0;break;case 90:t=0,n=e.width/e.scale*-1;break;case 180:t=e.width/e.scale*-1,n=e.height/e.scale*-1;break;case 270:t=e.height/e.scale*-1,n=0}return{x:t,y:n}}(t),o="scale("+t.scale+")";if(o+=" rotate("+t.rotation+")",o+=" translate("+n.x+", "+n.y+")",e.setAttribute("transform",o),!d&&"svg"===e.nodeName.toLowerCase()){e.setAttribute("x",parseInt(e.getAttribute("x"),10)*t.scale),e.setAttribute("y",parseInt(e.getAttribute("y"),10)*t.scale);var r=parseInt(e.getAttribute("x",10)),i=parseInt(e.getAttribute("y",10)),a=parseInt(e.getAttribute("width"),10),s=parseInt(e.getAttribute("height"),10),u=(e.querySelector("path"),[e]),c=e.querySelector("svg"),l=e.querySelector("path"),f=e.querySelector("rect"),p=e.querySelector("g");c&&u.push(c),l&&u.push(l),f&&u.push(f),p&&u.push(p);var v=t.rotation%360;switch(v<0&&(v+=360),v){case 90:e.setAttribute("x",t.width-i-a),e.setAttribute("y",r),c&&(c.setAttribute("x",1),c.setAttribute("y",0));break;case 180:e.setAttribute("x",t.width-r-a),e.setAttribute("y",t.height-i-s),c&&c.setAttribute("y",2);break;case 270:e.setAttribute("x",i),e.setAttribute("y",t.height-r-s),c&&(c.setAttribute("x",-1),c.setAttribute("y",0))}}return e}(u,n))),u},u(n(12));var o=u(n(13)),r=u(n(16)),i=u(n(17)),a=u(n(18)),s=u(n(19));function u(e){return e&&e.__esModule?e:{default:e}}var d=/firefox/i.test(navigator.userAgent);e.exports=t.default},function(e,t){var n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=Object.assign||function(e,t){for(var r,i,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),s=1;s<arguments.length;s++){for(var u in r=Object(arguments[s]))n.call(r,u)&&(a[u]=r[u]);if(Object.getOwnPropertySymbols){i=Object.getOwnPropertySymbols(r);for(var d=0;d<i.length;d++)o.call(r,i[d])&&(a[i[d]]=r[i[d]])}}return a}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return(0,o.default)(t,{stroke:(0,r.default)(e.color||"#f00"),strokeWidth:1}),e.rectangles.forEach(function(e){var n=document.createElementNS("http://www.w3.org/2000/svg","line");(0,o.default)(n,{x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y}),t.appendChild(n)}),t};var o=i(n(14)),r=i(n(15));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){Object.keys(t).forEach(function(n){e.setAttribute(r(n),t[n])})};var n=/[A-Z]/g,o=["viewBox"],r=function(e){return-1===o.indexOf(e)&&(e=e.replace(n,function(e){return"-"+e.toLowerCase()})),e};e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return n.test(e)&&(e="#"+e),e};var n=/^([a-f0-9]{6}|[a-f0-9]{3})$/i;e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],n=document.createElementNS("http://www.w3.org/2000/svg","path"),i=0,a=e.lines.length;i<a;i++){var s=e.lines[i],u=e.lines[i+1];s&&3!=s.length&&u&&3!=u.length&&t.push("M"+s[0]+" "+s[1]+" "+u[0]+" "+u[1])}return(0,o.default)(n,{d:t.join(" ")+"Z",stroke:(0,r.default)(e.color||"#000"),strokeWidth:e.width||1,fill:"none"}),n};var o=i(n(14)),r=i(n(15));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=document.createElementNS("http://www.w3.org/2000/svg","rect"),r=document.createElementNS("http://www.w3.org/2000/svg","path");return(0,i.default)(n,{width:a,height:a,x:0,y:.05*a*-1,viewBox:"0 0 1000 1000"}),(0,i.default)(o,{width:a,height:a,stroke:"#fff",fill:"#ff5"}),(0,i.default)(r,{d:s,strokeWidth:50,stroke:"#000",fill:"#fff"}),e.sub_type&&(0,i.default)(t,{width:28,height:25,x:e.x,y:e.y}),e.sub_type?t.innerHTML='<rect width="25" height="22" x="1.962286" y="1" style="fill:#ffff00;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-opacity:1" /> <rect width="18.4" height="1.5012145" x="5.8" y="5" style="fill:#000000;fill-opacity:1;stroke:none" /> <rect width="18" height="0.86" x="6" y="10" style="fill:#000000;fill-opacity:1;stroke:none" /> <rect width="18.4" height="0.86" x="5.8" y="14" style="fill:#000000;fill-opacity:1;stroke:none" /> <rect width="18" height="0.86" x="6" y="18" style="fill:#000000;fill-opacity:1;stroke:none" />':((0,i.default)(t,{width:a,height:a,x:e.x,y:e.y}),n.appendChild(r),t.appendChild(o),t.appendChild(n)),t};var o,r=n(14),i=(o=r)&&o.__esModule?o:{default:o},a=25,s="M499.968 214.336q-113.832 0 -212.877 38.781t-157.356 104.625 -58.311 142.29q0 62.496 39.897 119.133t112.437 97.929l48.546 27.9 -15.066 53.568q-13.392 50.778 -39.06 95.976 84.816 -35.154 153.45 -95.418l23.994 -21.204 31.806 3.348q38.502 4.464 72.54 4.464 113.832 0 212.877 -38.781t157.356 -104.625 58.311 -142.29 -58.311 -142.29 -157.356 -104.625 -212.877 -38.781z";e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===p(Symbol.iterator)?function(e){return void 0===e?"undefined":p(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":void 0===e?"undefined":p(e)};t.default=function(e){if("highlight"!==e.type){var t=s(e);return(0,r.default)(t,{stroke:(0,i.default)(e.color||"#f00"),fill:"none"}),t}var n,a=(n=document.createElementNS("http://www.w3.org/2000/svg","g"),(0,r.default)(n,{fill:(0,i.default)(e.color||"#ff0"),fillOpacity:.2}),e.rectangles.forEach(function(e){n.appendChild(s(e))}),{v:n});if("object"===(void 0===a?"undefined":o(a)))return a.v};var r=a(n(14)),i=a(n(15));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=document.createElementNS("http://www.w3.org/2000/svg","rect");return(0,r.default)(t,{x:e.x,y:e.y,width:e.width,height:e.height}),t}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","text");return(0,o.default)(t,{x:e.x,y:e.y+parseInt(e.size,10),fill:(0,r.default)(e.color||"#000"),fontSize:e.size}),t.innerHTML=e.content,t};var o=i(n(14)),r=i(n(15));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e=Array.isArray(e)?e:[],Object.keys(s).forEach(function(t){var n=s[t];e.filter(function(e){return e.type===t}).sort(n).forEach(function(e,t){return(0,o.default)(e,t+1)})})};var o=r(n(21));function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){return e.y<t.y?e.x-t.x:1}function a(e,t){return i(e.rectangles[0],t.rectangles[0])}(0,r(n(27)).default)();var s={highlight:a,strikeout:a,underline:a,drawing:function(e,t){var n=e.lines[0],o=t.lines[0];return i({x:n[0],y:n[1]},{x:o[0],y:o[1]})},textbox:i,point:i,area:i};e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];switch(e.type){case"highlight":case"strikeout":case"underline":var n=e.rectangles,a=n[0],s=n[n.length-1];c=(0,o.default)("Begin "+e.type+" annotation "+t,e.uuid),(0,i.default)(c,a.x,a.y,e.page,!0),c=(0,o.default)("End "+e.type+" annotation "+t,e.uuid+"-end"),(0,i.default)(c,s.x+s.width,s.y,e.page,!1);break;case"textbox":case"point":var u="textbox"===e.type?" (content: "+e.content+")":"";c=(0,o.default)(e.type+" annotation "+t+u,e.uuid),(0,r.default)(c,e.x,e.y,e.page);break;case"drawing":case"area":var d=void 0!==e.x?e.x:e.lines[0][0],l=void 0!==e.y?e.y:e.lines[0][1];c=(0,o.default)("Unlabeled drawing",e.uuid),(0,r.default)(c,d,l,e.page)}};var o=a(n(22)),r=a(n(23)),i=a(n(24));function a(e){return e&&e.__esModule?e:{default:e}}a(n(25)),e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=document.createElement("div"),o=document.createTextNode(e);return n.appendChild(o),n.setAttribute("id","pdf-annotate-screenreader-"+t),n.style.position="absolute",n.style.left="-10000px",n.style.top="auto",n.style.width="1px",n.style.height="1px",n.style.overflow="hidden",n},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o){if((0,i.default)(e,t,n,o,!0))return!0;var r=document.querySelector('svg[data-pdf-annotate-page="'+o+'"]'),s=r.getBoundingClientRect(),u=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(r.parentNode.querySelectorAll(".textLayer > div")));n=(0,a.scaleUp)(r,{y:n}).y+s.top,t=(0,a.scaleUp)(r,{x:t}).x+s.left;for(var d=0,c=u.length;d<c;d++){var l=u[d],f=l.getBoundingClientRect();if(n<=f.top)return l.parentNode.insertBefore(e,l),!0}var p=r.parentNode.querySelector(".textLayer");if(p){var v=p.getBoundingClientRect();if((0,a.pointIntersectsRect)(t,n,v))return p.appendChild(e),!0}return!1};var o,r=n(24),i=(o=r)&&o.__esModule?o:{default:o},a=n(6);e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,i){var a=function(e,t,n){var r=document.querySelector('svg[data-pdf-annotate-page="'+n+'"]'),i=r.getBoundingClientRect();return t=(0,o.scaleUp)(r,{y:t}).y+i.top,e=(0,o.scaleUp)(r,{x:e}).x+i.left,[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(r.parentNode.querySelectorAll(".textLayer [data-canvas-width]"))).filter(function(n){return(0,o.pointIntersectsRect)(e,t,n.getBoundingClientRect())})[0]}(t=Math.max(t+2*(i?1:-1),0),n+2,r);if(!a)return!1;t+=2*(i?-1:1);var s=document.querySelector('svg[data-pdf-annotate-page="'+r+'"]'),u=(0,o.scaleDown)(s,{left:a.getBoundingClientRect().left}).left-s.getBoundingClientRect().left,d=a.cloneNode(!0),c=d.innerHTML.split(""),l=[];for(d.style.position="absolute",d.style.top="-10000px",d.style.left="-10000px",document.body.appendChild(d);c.length;){if(">"===c[c.length-1])for(;c.length&&(l.unshift(c.pop()),"<"!==l[0]););d.innerHTML=c.join("");var f=(0,o.scaleDown)(s,{width:d.getBoundingClientRect().width}).width;if(u+f<=t)break;l.unshift(c.pop())}return a.innerHTML=c.join("")+e.outerHTML+l.join(""),d.parentNode.removeChild(d),!0};var o=n(6);e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return(Array.isArray(n)?Promise.resolve(n):o.default.getStoreAdapter().getComments(e,t)).then(function(e){var n=document.getElementById("pdf-annotate-screenreader-"+t);if(n){var o=document.createElement("ol");o.setAttribute("id","pdf-annotate-screenreader-comment-list-"+t),o.setAttribute("aria-label","Comments"),n.appendChild(o),e.forEach(r.default)}})};var o=i(n(1)),r=i(n(26));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e){var t=document.querySelector("#pdf-annotate-screenreader-"+e.annotation+" ol");if(t){var n=document.createElement("li");n.setAttribute("id","pdf-annotate-screenreader-comment-"+e.uuid),n.appendChild(document.createTextNode(""+e.content)),t.appendChild(n)}}},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,a.addEventListener)("annotation:add",function(e,t,n){d(e,t,n.type)}),(0,a.addEventListener)("annotation:edit",function(e,t,n){d(e,n.page,n.type)}),(0,a.addEventListener)("annotation:delete",c),(0,a.addEventListener)("comment:add",l),(0,a.addEventListener)("comment:delete",f)},u(n(21));var o=u(n(20)),r=u(n(26)),i=u(n(25)),a=n(4),s=u(n(1));function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n){s.default.getStoreAdapter().getAnnotations(e,t).then(function(e){return e.annotations.filter(function(e){return e.type===n})}).then(function(e){return e.forEach(function(e){c(0,e.uuid)}),e}).then(o.default)}function c(e,t){p("pdf-annotate-screenreader-"+t),p("pdf-annotate-screenreader-"+t+"-end")}function l(e,t,n){var o=document.querySelector("pdf-annotate-screenreader-comment-list-"+t);(o?Promise.resolve(!0):(0,i.default)(e,t,[]).then(function(){return o=document.querySelector("pdf-annotate-screenreader-comment-list-"+t),!0})).then(function(){(0,r.default)(n)})}function f(e,t){p("pdf-annotate-screenreader-comment-"+t)}function p(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)}e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=n(29),i=n(30),a=n(31),s=n(32),u=n(33),d=n(34);t.default={addEventListener:o.addEventListener,removeEventListener:o.removeEventListener,fireEvent:o.fireEvent,disableEdit:r.disableEdit,enableEdit:r.enableEdit,destroyEditOverlay:r.destroyEditOverlay,disablePen:i.disablePen,enablePen:i.enablePen,setPen:i.setPen,disablePoint:a.disablePoint,enablePoint:a.enablePoint,disableRect:s.disableRect,enableRect:s.enableRect,disableText:u.disableText,enableText:u.enableText,setText:u.setText,createPage:d.createPage,renderPage:d.renderPage,renderPageWithoutAnnotations:d.renderPageWithoutAnnotations},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};t.enableEdit=function(e){c||(e?w(e):(c=!0,(0,a.addEventListener)("annotation:click",m)))},t.disableEdit=function(){x(),c&&(c=!1,(0,a.removeEventListener)("annotation:click",m))},t.destroyEditOverlay=x;var r=u(n(1)),i=u(n(11)),a=n(4),s=n(6);function u(e){return e&&e.__esModule?e:{default:e}}function d(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var c=!1,l=!1,p=void 0,v=void 0,g=void 0,y=void 0,b=void 0,_=3;function w(e){x(),p=document.createElement("div");var t=document.createElement("a"),n=(0,s.findSVGContainer)(e).parentNode,o=e.getAttribute("data-pdf-annotate-id"),r=(0,s.getAnnotationRect)(e),i=r.left-_,a=r.top-_;p.setAttribute("id","pdf-annotate-edit-overlay"),p.setAttribute("data-target-id",o),p.style.boxSizing="content-box",p.style.position="absolute",p.style.top=a+"px",p.style.left=i+"px",p.style.width=r.width+"px",p.style.height=r.height+"px",p.style.border=_+"px solid "+s.BORDER_COLOR,p.style.borderRadius=_+"px",t.innerHTML="",t.setAttribute("href","javascript://"),t.style.background="#fff",t.style.borderRadius="20px",t.style.border="1px solid #bbb",t.style.color="#bbb",t.style.fontSize="16px",t.style.padding="2px",t.style.textAlign="center",t.style.textDecoration="none",t.style.position="absolute",t.style.top="-13px",t.style.right="-13px",t.style.width="25px",t.style.height="25px",p.appendChild(t),n.appendChild(p),document.addEventListener("click",C),document.addEventListener("keyup",S),document.addEventListener("mousedown",k),t.addEventListener("click",A),t.addEventListener("mouseover",function(){t.style.color="#35A4DC",t.style.borderColor="#999",t.style.boxShadow="0 1px 1px #ccc"}),t.addEventListener("mouseout",function(){t.style.color="#bbb",t.style.borderColor="#bbb",t.style.boxShadow=""}),p.addEventListener("mouseover",function(){l||(t.style.display="")}),p.addEventListener("mouseout",function(){t.style.display="none"})}function x(){p&&(p.parentNode.removeChild(p),p=null),document.removeEventListener("click",C),document.removeEventListener("keyup",S),document.removeEventListener("mousedown",k),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",P),(0,s.enableUserSelect)()}function A(){if(p){var e=p.getAttribute("data-target-id"),t=document.querySelectorAll('[data-pdf-annotate-id="'+e+'"]'),n=p.parentNode.querySelector("svg.annotationLayer"),o=(0,s.getMetadata)(n).documentId,i=localStorage.getItem(o+"/annotations");if(i){var a=JSON.parse(i).filter(function(t){return t.uuid==e});if(a.length>0&&"point"==a[0].type&&!a[0].sub_type)return}[].concat(d(t)).forEach(function(e){e.parentNode.removeChild(e)}),r.default.getStoreAdapter().deleteAnnotation(o,e),x()}}function C(e){if((0,s.findSVGAtPoint)(e.clientX,e.clientY)){var t=document.getElementById("pdf-annotate-edit-overlay");if(t){if(l||e.target===t)return;x()}}}function S(e){p&&46===e.keyCode&&"textarea"!==e.target.nodeName.toLowerCase()&&"input"!==e.target.nodeName.toLowerCase()&&A()}var E=void 0;function k(e){if(e.target===p){var t=p.getAttribute("data-target-id"),n=document.querySelector('[data-pdf-annotate-id="'+t+'"]').getAttribute("data-pdf-annotate-type");if("highlight"!==n&&"strikeout"!==n&&"underline"!==n){l=!0,v=e.clientX,g=e.clientY,y=p.offsetLeft,b=p.offsetTop,p.style.background="rgba(255, 255, 255, 0.7)",p.style.cursor="move";var o=p.querySelector("a");o&&o.style&&(o.style.display="none"),document.addEventListener("mousemove",L),document.addEventListener("mouseup",P),(0,s.disableUserSelect)(),E=0!=(E=$('.new_comments_count[point_id="'+t+'"]')).length&&E[0]}}}function L(e){p.getAttribute("data-target-id");var t=p.parentNode.getBoundingClientRect(),n=b+(e.clientY-g),o=y+(e.clientX-v),r=t.height,i=t.width;n>0&&n+p.offsetHeight<r&&(p.style.top=n+"px",E&&(E.style.top=n-15+"px")),o>0&&o+p.offsetWidth<i&&(p.style.left=o+"px",E&&(E.style.left=o+20+"px"))}function P(e){var t=p.getAttribute("data-target-id"),n=document.querySelectorAll('[data-pdf-annotate-id="'+t+'"]'),a=n[0].getAttribute("data-pdf-annotate-type"),u=p.parentNode.querySelector("svg.annotationLayer"),c=(0,s.getMetadata)(u).documentId,f=p.querySelector("a");function v(e,t){return{deltaX:_+(0,s.scaleDown)(u,{x:p.offsetLeft}).x-e,deltaY:_+(0,s.scaleDown)(u,{y:p.offsetTop}).y-t}}f&&f.style&&(f.style.display=""),r.default.getStoreAdapter().getAnnotation(c,t).then(function(e){var l,f,p,m,h;["area","highlight","point","textbox"].indexOf(a)>-1?(l="x",f="y",p=v(parseInt(n[0].getAttribute(l),10),parseInt(n[0].getAttribute(f),10)),m=p.deltaX,h=p.deltaY,[].concat(d(n)).forEach(function(t,n){if(0!==h){var o=parseInt(t.getAttribute("y"),10)+h,r=o;"textbox"===a&&(r+=e.size),"point"===a&&(r=(0,s.scaleUp)(u,{viewY:r}).viewY),t.setAttribute("y",r),e.rectangles?e.rectangles[n].y=o:e.y&&(e.y=o)}if(0!==m){var i=parseInt(t.getAttribute("x"),10)+m,d=i;"point"===a&&(d=(0,s.scaleUp)(u,{viewX:d}).viewX),t.setAttribute("x",d),e.rectangles?e.rectangles[n].x=i:e.x&&(e.x=i)}})):"drawing"===a&&function(){var t=(0,s.scaleDown)(u,(0,s.getAnnotationRect)(n[0])),r=o(e.lines[0],2),a=r[0],d=r[1],c=v(a,d),l=c.deltaX,f=c.deltaY;f+=d-t.top,l+=a-t.left,e.lines.forEach(function(t,n){var r=o(e.lines[n],2),i=r[0],a=r[1];e.lines[n][0]=i+l,e.lines[n][1]=a+f}),n[0].parentNode.removeChild(n[0]),(0,i.default)(u,e)}(),r.default.getStoreAdapter().editAnnotation(c,t,e)}),setTimeout(function(){l=!1},0),p.style.background="",p.style.cursor="",document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",P),(0,s.enableUserSelect)()}m=function(e){setTimeout(function(){f=e.getAttribute("data-pdf-annotate-id"),w(e),h(e)},15)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.setPen=function(){var e=arguments.length<=0||void 0===arguments[0]?1:arguments[0],t=arguments.length<=1||void 0===arguments[1]?"000000":arguments[1];u=parseInt(e,10),d=t},t.enablePen=function(){s||(is_mobile_device&&$("body").css("overflow","hidden"),s=!0,document.addEventListener("mousedown",f),document.addEventListener("touchstart",f),(0,i.disableUserSelect)())},t.disablePen=function(){s&&(s=!1,document.removeEventListener("mousedown",f),document.removeEventListener("touchstart",f),(0,i.enableUserSelect)())};var o=a(n(1)),r=a(n(11)),i=n(6);function a(e){return e&&e.__esModule?e:{default:e}}var s=!1,u=void 0,d=void 0,c=void 0,l=void 0;function f(e){is_mobile_device&&$("body").css("overflow","hidden"),c=null,l=[],document.addEventListener("mousemove",v),document.addEventListener("mouseup",p),document.addEventListener("touchmove",v,{passive:!1}),document.addEventListener("touchend",p)}function p(e){e.changedTouches&&(e=e.changedTouches[0]);var t=void 0;if(l.length>1&&(t=(0,i.findSVGAtPoint)(e.clientX,e.clientY))){var n=(0,i.getMetadata)(t),a=n.documentId,s=n.pageNumber;l[l.length-1].push(-1),o.default.getStoreAdapter().addAnnotation(a,s,{type:"drawing",width:u,color:d,lines:l}).then(function(e){c&&t.removeChild(c),(0,r.default)(t,e)})}document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",p),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",p),is_mobile_device&&$("body").css("overflow","auto")}function v(e){e.preventDefault(),e.touches&&(e=e.touches[0]),function(e,t){var n=(0,i.findSVGAtPoint)(e,t);if(n){var o=n.getBoundingClientRect(),a=(0,i.scaleDown)(n,{x:e-o.left,y:t-o.top});l.push([a.x,a.y]),l.length<=1||(c&&n.removeChild(c),c=(0,r.default)(n,{type:"drawing",color:d,width:u,lines:l}))}}(e.clientX,e.clientY)}},function(t,n,o){Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"===p(Symbol.iterator)?function(e){return void 0===e?"undefined":p(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":void 0===e?"undefined":p(e)};n.enablePoint=function(){c||(c=!0,document.addEventListener("mouseup",v))},n.disablePoint=function(){c&&(c=!1,document.removeEventListener("mouseup",v))};var i=d(o(1)),a=d(o(11)),u=o(6);function d(e){return e&&e.__esModule?e:{default:e}}var c=!1,f=void 0;function v(e){!f&&(0,u.findSVGAtPoint)(e.clientX,e.clientY)&&((f=document.createElement("input")).setAttribute("id","pdf-annotate-point-input"),f.setAttribute("placeholder","Enter comment"),f.style.border="3px solid "+u.BORDER_COLOR,f.style.borderRadius="3px",f.style.position="fixed",f.style.top=e.clientY+"px",f.style.left=e.clientX+"px",f.addEventListener("blur",m),f.addEventListener("keyup",h),document.body.appendChild(f),f.focus())}function m(){g()}function h(e){27===e.keyCode?y():13===e.keyCode&&g()}function g(){if(0!=f.value.trim().length){if(f.value.trim().length>0){var t=function(){var t=parseInt(f.style.left,10),n=parseInt(f.style.top,10),o=f.value.trim(),r=(0,u.findSVGAtPoint)(t,n);if(!r)return{v:void 0};var d=r.getBoundingClientRect(),c=(0,u.getMetadata)(r),p=c.documentId,v=c.pageNumber,m=Object.assign({type:"point"},(0,u.scaleDown)(r,{x:t-d.left,y:n-d.top})),h=i.default.getStoreAdapter();m.sub_type=s,m.counter=0,h.addAnnotation(p,v,m).then(function(t){var n={content:o,date_time:new Date,uid:e.id,user_name:e.name,user_image:e.photo};h.addComment(p,t.uuid,n),(0,a.default)(r,t);var i=t.uuid,s=$("select.scale").val(),u="<div point_id="+t.uuid+' class="new_comments_count"';u+=' comment_count="0" style="top:'+(t.y*s-15)+"px;left:"+(t.x*s+15)+'px;;display:none;">0</div>',u=$(u),$("#pageContainer"+v+" .canvasWrapper").append(u),l(i)})}();if("object"===(void 0===t?"undefined":r(t)))return t.v}y()}else y()}function y(){f.removeEventListener("blur",m),f.removeEventListener("keyup",h),document.body.removeChild(f),f=null}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.enableRect=function(e){d=e,u||(u=!0,document.addEventListener("mouseup",g),document.addEventListener("mousedown",p),document.addEventListener("keyup",m),g(e))},t.disableRect=function(){u&&(u=!1,document.removeEventListener("mouseup",g),document.removeEventListener("mousedown",p),document.removeEventListener("keyup",m))};var o=a(n(1)),r=a(n(11)),i=n(6);function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var u=!1,d=void 0,c=void 0,l=void 0,f=void 0;function p(e){var t=void 0;if("area"===d&&(t=(0,i.findSVGAtPoint)(e.clientX,e.clientY))){var n=t.getBoundingClientRect();l=e.clientY,f=e.clientX,(c=document.createElement("div")).style.position="absolute",c.style.top=l-n.top+"px",c.style.left=f-n.left+"px",c.style.border="3px solid "+i.BORDER_COLOR,c.style.borderRadius="3px",t.parentNode.appendChild(c),document.addEventListener("mousemove",v),(0,i.disableUserSelect)()}}function v(e){var t=c.parentNode.querySelector("svg.annotationLayer").getBoundingClientRect();f+(e.clientX-f)<t.right&&(c.style.width=e.clientX-f+"px"),l+(e.clientY-l)<t.bottom&&(c.style.height=e.clientY-l+"px")}function m(e){27===e.keyCode&&(window.getSelection().removeAllRanges(),c&&c.parentNode&&(c.parentNode.removeChild(c),c=null,document.removeEventListener("mousemove",v)))}function h(e,t,n){var a=(0,i.findSVGAtPoint)(t[0].left,t[0].top),u=void 0;if(a){var d=a.getBoundingClientRect();if(n||("highlight"===e?n="FFFF00":"strikeout"===e?n="FF0000":"underline"===e&&(n="00FF00")),0!==(u={type:e,color:n,rectangles:[].concat(s(t)).map(function(t){var n=0;return"strikeout"===e?n=t.height/2:"underline"===e&&(n=t.height-2),(0,i.scaleDown)(a,{y:t.top+n-d.top,x:t.left-d.left,width:t.width,height:t.height})}).filter(function(e){return e.width>0&&e.height>0&&e.x>-1&&e.y>-1})}).rectangles.length){if("area"===e){var c=u.rectangles[0];delete u.rectangles,u.x=c.x,u.y=c.y,u.width=c.width,u.height=c.height}var l=(0,i.getMetadata)(a),f=l.documentId,p=l.pageNumber;o.default.getStoreAdapter().addAnnotation(f,p,u).then(function(e){(0,r.default)(a,e)})}}}function g(e){if("string"==typeof e){var t=void 0;if("area"!==(d=e)&&(t=function(){try{var e=window.getSelection().getRangeAt(0).getClientRects();if(e.length>0&&e[0].width>0&&e[0].height>0)return e}catch(e){}return null}())){(0,i.findSVGAtPoint)(t[0].left,t[0].top);var n=s(t),o=(n=[].concat(n)).map(function(e){return{top:e.top,left:e.left,width:e.width,height:e.height}});h(d,o)}else if("area"===d&&c){var r=c.parentNode.querySelector("svg.annotationLayer").getBoundingClientRect();h(d,[{top:parseInt(c.style.top,10)+r.top,left:parseInt(c.style.left,10)+r.left,width:parseInt(c.style.width,10),height:parseInt(c.style.height,10)}]),c.parentNode.removeChild(c),c=null,document.removeEventListener("mousemove",v),(0,i.enableUserSelect)()}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===p(Symbol.iterator)?function(e){return void 0===e?"undefined":p(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":void 0===e?"undefined":p(e)};t.setText=function(){var e=arguments.length<=0||void 0===arguments[0]?12:arguments[0],t=arguments.length<=1||void 0===arguments[1]?"000000":arguments[1];c=parseInt(e,10),l=t},t.enableText=function(){u||(u=!0,document.addEventListener("mouseup",f))},t.disableText=function(){u&&(u=!1,document.removeEventListener("mouseup",f))};var r=s(n(1)),i=s(n(11)),a=n(6);function s(e){return e&&e.__esModule?e:{default:e}}var u=!1,d=void 0,c=void 0,l=void 0;function f(e){!d&&(0,a.findSVGAtPoint)(e.clientX,e.clientY)&&((d=document.createElement("input")).setAttribute("id","pdf-annotate-text-input"),d.setAttribute("placeholder","Enter text"),d.style.border="3px solid "+a.BORDER_COLOR,d.style.borderRadius="3px",d.style.position="absolute",d.style.top=e.clientY+"px",d.style.left=e.clientX+"px",d.style.fontSize=c+"px",d.addEventListener("blur",v),d.addEventListener("keyup",m),document.body.appendChild(d),d.focus())}function v(){h()}function m(e){27===e.keyCode?g():13===e.keyCode&&h()}function h(){if(d.value.trim().length>0){var e=function(){var e=parseInt(d.style.left,10),t=parseInt(d.style.top,10),n=(0,a.findSVGAtPoint)(e,t);if(!n)return{v:void 0};var o=(0,a.getMetadata)(n),s=o.documentId,u=o.pageNumber,f=n.getBoundingClientRect(),p=Object.assign({type:"textbox",size:c,color:l,content:d.value.trim()},(0,a.scaleDown)(n,{x:e-f.left,y:t-f.top,width:d.offsetWidth,height:d.offsetHeight}));r.default.getStoreAdapter().addAnnotation(s,u,p).then(function(e){(0,i.default)(n,e)})}();if("object"===(void 0===e?"undefined":o(e)))return e.v}g()}function g(){d&&(d.removeEventListener("blur",v),d.removeEventListener("keyup",m),document.body.removeChild(d),d=null)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};t.createPage=function(e){var t=document.createElement("div");t.innerHTML=s;var n=t.children[0],o=n.querySelector("canvas");return n.setAttribute("id","pageContainer"+e),n.setAttribute("data-page-number",e),o.mozOpaque=!0,o.setAttribute("id","page"+e),n},t.renderPage=function(e,t,n){var a=t.documentId,s=t.pdfDocument,d=t.scale,c=t.rotate,l=s.getPage(e),f=r.default.getAnnotations(a,e),p=[l,f];return Promise.all(p).then(function(t){var a=o(t,2),s=a[0],l=a[1],f=document.getElementById("pageContainer"+e);if(f){var p=f.querySelector(".annotationLayer"),v=f.querySelector(".canvasWrapper canvas"),m=v.getContext("2d",{alpha:!1}),h=s.getViewport(d,c);if(h){var g=u(e,h,m),y=s.render({canvasContext:m,viewport:h,transform:g}),b=r.default.render(p,h,l);return Promise.all([y,b]).then(function(){return s.getTextContent({normalizeWhitespace:!0}).then(function(t){return new Promise(function(n,o){var r=f.querySelector(".textLayer"),a=new PDFJS.DefaultTextLayerFactory,s=a.createTextLayerBuilder(r,e-1,h);s.setTextContent(t),s.render(),setTimeout(function(){try{(0,i.default)(l.annotations),n()}catch(e){o(e)}})})})}).then(function(){return f.setAttribute("data-loaded","true"),n&&n(l.annotations,e),[s,l]})}console.log(d,c,s,"Invalid view port")}else console.log("1. Invalid page container pageContainer"+e)})},t.renderPageWithoutAnnotations=function(e,t,n){t.documentId;var a=t.pdfDocument,s=t.scale,d=t.rotate,c=[a.getPage(e),[]];return Promise.all(c).then(function(t){var a=o(t,2),c=a[0],l=[],f=document.getElementById("pageContainer"+e);if(f){var p=f.querySelector(".annotationLayer"),v=f.querySelector(".canvasWrapper canvas"),m=v.getContext("2d",{alpha:!1}),h=c.getViewport(s,d);if(h){var g=u(e,h,m),y=c.render({canvasContext:m,viewport:h,transform:g}),b=r.default.render(p,h,l);return Promise.all([y,b]).then(function(){return c.getTextContent({normalizeWhitespace:!0}).then(function(t){return new Promise(function(o,r){var a=f.querySelector(".textLayer"),s=new PDFJS.DefaultTextLayerFactory,u=s.createTextLayerBuilder(a,e-1,h);u.setTextContent(t),u.render(),setTimeout(function(){try{(0,i.default)(l.annotations),n&&n(),o()}catch(e){r(e)}})})})}).then(function(){return f.setAttribute("data-loaded","true"),[c,l]})}console.log(s,d,c,"Invalid view port")}else console.log("2. Invalid page container pageContainer"+e)})};var r=a(n(1)),i=a(n(20));function a(e){return e&&e.__esModule?e:{default:e}}var s='\n  <div style="visibility: hidden;" class="page" data-loaded="false">\n    <div class="canvasWrapper">\n      <canvas></canvas>\n    </div>\n    <svg class="annotationLayer"></svg>\n    <div class="textLayer"></div>\n  </div>\n';function u(e,t,n){var o=document.getElementById("pageContainer"+e);if(o){var r,i,a,s,u=o.querySelector(".annotationLayer"),l=o.querySelector(".canvasWrapper canvas"),f=o.querySelector(".canvasWrapper"),p=o.querySelector(".textLayer"),v=(r=n,i=window.devicePixelRatio||1,a=r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1,{sx:s=i/a,sy:s,scaled:1!==s}),m=v.scaled?[v.sx,0,0,v.sy,0,0]:null,h=d(v.sx),g=d(v.sy);return o.style.visibility="",l.width=c(t.width*v.sx,h[0]),l.height=c(t.height*v.sy,g[0]),l.style.width=c(t.width,h[1])+"px",l.style.height=c(t.height,h[1])+"px",u.setAttribute("width",t.width),u.setAttribute("height",t.height),u.style.width=t.width+"px",u.style.height=t.height+"px",o.style.width="100%",o.style.height=t.height+"px",f.style.width=t.width+"px",f.style.height=t.height+"px",p.style.width="100%",p.style.height=t.height+"px",$("#viewer").width(t.width),m}console.log("3. Invalid page container pageContainer"+e)}function d(e){if(Math.floor(e)===e)return[e,1];var t=1/e;if(t>8)return[1,8];if(Math.floor(t)===t)return[1,t];for(var n=e>1?t:e,o=0,r=1,i=1,a=1;;){var s=o+i,u=r+a;if(u>8)break;n<=s/u?(i=s,a=u):(o=s,r=u)}return n-o/r<i/a-n?n===e?[o,r]:[r,o]:n===e?[i,a]:[a,i]}function c(e,t){var n=e%t;return 0===n?e:Math.round(e-n+t)}}])},"object"===p(n)&&"object"===p(t)?t.exports=o():(a=[],void 0===(u="function"==typeof(i=o)?i.apply(n,a):i)||(t.exports=u))}).call(n,o(3)(t))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){function r(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1];c.setAttribute("data-color",e),c.style.background=e,t&&"function"==typeof o&&o(e),i()}function i(){document.removeEventListener("keyup",s),u&&u.parentNode&&u.parentNode.removeChild(u),d=!1,c.focus()}function a(e){var t=document.createElement("a");return t.className="color",t.setAttribute("href","javascript://"),t.setAttribute("title",e.name),t.setAttribute("data-color",e.hex),t.style.background=e.hex,t}function s(e){27===e.keyCode&&i()}var u=void 0,d=!1,c=a({hex:t});c.onclick=function(){d?i():(u||((u=document.createElement("div")).style.background="#fff",u.style.border="1px solid #ccc",u.style.padding="2px",u.style.position="absolute",u.style.width="122px",e.style.position="relative",n.map(a).forEach(function(e){e.style.margin="2px",e.onclick=function(){r(e.getAttribute("data-color"))},u.appendChild(e)})),document.addEventListener("keyup",s),e.appendChild(u),d=!0)},r(t,!1)};var n=[{hex:"#000000",name:"Black"},{hex:"#EF4437",name:"Red"},{hex:"#E71F63",name:"Pink"},{hex:"#8F3E97",name:"Purple"},{hex:"#65499D",name:"Deep Purple"},{hex:"#4554A4",name:"Indigo"},{hex:"#2083C5",name:"Blue"},{hex:"#35A4DC",name:"Light Blue"},{hex:"#09BCD3",name:"Cyan"},{hex:"#009688",name:"Teal"},{hex:"#43A047",name:"Green"},{hex:"#8BC34A",name:"Light Green"},{hex:"#FDC010",name:"Yellow"},{hex:"#F8971C",name:"Orange"},{hex:"#F0592B",name:"Deep Orange"},{hex:"#F06291",name:"Light Pink"}]}]);window.pdf_js_module=N}();